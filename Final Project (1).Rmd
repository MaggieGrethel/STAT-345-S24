---
title: "STAT443 Final Project"
author: "Maggie Wesolowski, Maggie Grethel, Jayden Koenig, Sarah Rodriguez"
date: "2024-12-15"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

# Introduction

The goal of this project is to classify households into one of four poverty levels based on a range of socioeconomic and demographic variables. The dataset provides both household and individual level variables. Some example variables include: the status of the flooring of a house, number of individuals living in a house, house location region, and electricity and toilet status in a house. We will be focusing on the heads of household to develop a predictive model that balances interpretability with predictive power. This classification can help identify vulnerable groups and guide social policies. Key considerations include handling missing data and ensuring appropriate feature representation.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(randomForest)
library(caret)
library(MLmetrics)
library(nnet)
```

```{r include=FALSE}
poverty = read.csv("poverty.csv")
poverty_test = read.csv("poverty-test-blinded.csv")
```

# Exploring Data

During exploration, we identified missing values in several variables, such as v2a1 (monthly rent) and rez_esc (years behind in school). Missing values in v2a1 often occur when households own their homes and do not pay rent, suggesting that these missing values can reasonably be imputed as 0. For other variables with missing data, we need to determine if the data is missing at random. Depending on the nature of the missingness, strategies such as mean/mode imputation or introducing a new "unknown" category will be applied.

## Exploring Missing Values

-   If the value of v18q is 0, then the value in v18q1 is NA. Therefore, we convert NAs in v18q1 to be 0, meaning the number of tablets a household owns in 0.

```{r include=FALSE}
poverty$v18q1[is.na(poverty$v18q1)] = 0
```

-   The missing values in v2a1 (monthly rent) are because the house is owned and fully paid. When tipovivi1 is 1, v2a1 is NA.

```{r include=FALSE}
#this checks that condition
all(poverty$tipovivi1 != 1 | is.na(poverty$v2a1))

#replaces NA values with 0 because there is no monthly rent payment since the house is owned and fully paid
poverty$v2a1[is.na(poverty$v2a1)] = 0
```

## Fixing Coding Error

-   'Edjefe' is supposed to be the years of education of male head of household. The variable should only contain numeric values for male heads of household. However, it contains 'yes' and 'no'. With 'no' meaning that person is neither a male nor the head of household. And 'yes' being that person is male and head of household. This is the same for the variable 'edjefa'.

```{r include=FALSE}
# Find cases where edjefe is "yes", but either male is not 1 or parentesco1 is not 1
incorrect_condition <- poverty$edjefe == "yes" & (poverty$male != 1 | poverty$parentesco1 != 1)

#TRUE means the condition doesn't hold, FALSE means it's satisfied.
table(incorrect_condition)

#same thing but for edjefa
incorrect_condition1 <- poverty$edjefa == "yes" & (poverty$female != 1 | poverty$parentesco1 != 1)
table(incorrect_condition1)
```

-   There is 120 cases where 'edeje' and 'edjefa' were coded incorrectly. To fix this we check where that inconsistency is and change it. For instance, if there is a 'yes' in 'edjefe' but that person is neither male nor head of household, the 'yes' is change to a 'no'. And we will do the same for the 'edjefa' variable to ensure that the data is consistent.

```{r include=FALSE}
#correcting the data by changing "yes" to "no" in edjefe where it's inconsistent
poverty$edjefe <- ifelse(poverty$edjefe == "yes" & !(poverty$male == 1 & poverty$parentesco1== 1), "no", poverty$edjefe)

#correcting the data by changing "yes" to "no" in edjefa where it's inconsistent
poverty$edjefa <- ifelse(poverty$edjefa == "yes" & !(poverty$female == 1 & poverty$parentesco1 == 1), "no", poverty$edjefa)
```

-   Now that the variables have been corrected and are consistent, the next thing we need to do is replace the 'yes' in each column with the years of education from the 'escolari' variable. If there is a 'no' then the value will be NA. In this case, it makes sense to have a missing value because it is not relevant to know the years of education if that person does not meet the requirements for that variable.

```{r include=FALSE}
poverty$edjefe <- ifelse(poverty$edjefe == "yes" & poverty$parentesco1 == 1 & poverty$male == 1, poverty$escolari, as.numeric(poverty$edjefe))

poverty$edjefa <- ifelse(poverty$edjefa == "yes" & poverty$parentesco1 == 1 & poverty$female == 1, poverty$escolari, as.numeric(poverty$edjefa))

```

## Fixing Redundencies

Having separate columns for female and male is redundant, so we made one column for gender with male = 1 and 0 = female.

```{r include=FALSE}
poverty$gender = ifelse(poverty$male == 1, 1, 0)
```

```{r include=FALSE}
#variables 

#makes variable ordinal 
target = factor(poverty$Target, ordered = TRUE)

#factoring variables 
hacdor = factor(poverty$hacdor)
hacapo = factor(poverty$hacapo)
v14a = factor(poverty$v14a)
refrig = factor(poverty$refrig)
v18q = factor(poverty$v18q)
paredblolad = factor(poverty$paredblolad)
paredzocalo <- factor(poverty$paredzocalo)
paredpreb <- factor(poverty$paredpreb)
pareddes <- factor(poverty$pareddes)
paredmad <- factor(poverty$paredmad)
paredzinc <- factor(poverty$paredzinc)
paredfibras <- factor(poverty$paredfibras)
paredother <- factor(poverty$paredother)
pisomoscer <- factor(poverty$pisomoscer)
pisocemento <- factor(poverty$pisocemento)
pisoother <- factor(poverty$pisoother)
pisonatur <- factor(poverty$pisonatur)
pisonotiene <- factor(poverty$pisonotiene)
pisomadera <- factor(poverty$pisomadera)
techozinc <- factor(poverty$techozinc)
techoentrepiso <- factor(poverty$techoentrepiso)
techocane <- factor(poverty$techocane)
techootro <- factor(poverty$techootro)
cielorazo <- factor(poverty$cielorazo)
abastaguadentro <- factor(poverty$abastaguadentro)
abastaguafuera <- factor(poverty$abastaguafuera)
abastaguano <- factor(poverty$abastaguano)
public <- factor(poverty$public)
planpri <- factor(poverty$planpri)
noelec <- factor(poverty$noelec)
coopele <- factor(poverty$coopele)
sanitario1 <- factor(poverty$sanitario1)
sanitario2 <- factor(poverty$sanitario2)
sanitario3 <- factor(poverty$sanitario3)
sanitario5 <- factor(poverty$sanitario5)
sanitario6 <- factor(poverty$sanitario6)
energcocinar1 <- factor(poverty$energcocinar1)
energcocinar2 <- factor(poverty$energcocinar2)
energcocinar3 <- factor(poverty$energcocinar3)
energcocinar4 <- factor(poverty$energcocinar4)
elimbasu1 <- factor(poverty$elimbasu1)
elimbasu2 <- factor(poverty$elimbasu2)
elimbasu3 <- factor(poverty$elimbasu3)
elimbasu4 <- factor(poverty$elimbasu4)
elimbasu5 <- factor(poverty$elimbasu5)
elimbasu6 <- factor(poverty$elimbasu6)
epared1 <- factor(poverty$epared1)
epared2 <- factor(poverty$epared2)
epared3 <- factor(poverty$epared3)
etecho1 <- factor(poverty$etecho1)
etecho2 <- factor(poverty$etecho2)
etecho3 <- factor(poverty$etecho3)
eviv1 <- factor(poverty$eviv1)
eviv2 <- factor(poverty$eviv2)
eviv3 <- factor(poverty$eviv3)
dis <- factor(poverty$dis)
male <- factor(poverty$male)
female <- factor(poverty$female)
estadocivil1 <- factor(poverty$estadocivil1)
estadocivil2 <- factor(poverty$estadocivil2)
estadocivil3 <- factor(poverty$estadocivil3)
estadocivil4 <- factor(poverty$estadocivil4)
estadocivil5 <- factor(poverty$estadocivil5)
estadocivil6 <- factor(poverty$estadocivil6)
estadocivil7 <- factor(poverty$estadocivil7)
parentesco1 <- factor(poverty$parentesco1)
parentesco2 <- factor(poverty$parentesco2)
parentesco3 <- factor(poverty$parentesco3)
parentesco4 <- factor(poverty$parentesco4)
parentesco5 <- factor(poverty$parentesco5)
parentesco6 <- factor(poverty$parentesco6)
parentesco7 <- factor(poverty$parentesco7)
parentesco8 <- factor(poverty$parentesco8)
parentesco9 <- factor(poverty$parentesco9)
parentesco10 <- factor(poverty$parentesco10)
parentesco11 <- factor(poverty$parentesco11)
parentesco12 <- factor(poverty$parentesco12)
idhogar <- factor(poverty$idhogar)
lugar1 <- factor(poverty$lugar1)
lugar2 <- factor(poverty$lugar2)
lugar3 <- factor(poverty$lugar3)
lugar4 <- factor(poverty$lugar4)
lugar5 <- factor(poverty$lugar5)

area1 <- factor(poverty$area1)
area2 <- factor(poverty$area2)

#other variables that don't need to be factor
gender = poverty$gender
v2a1 = poverty$v2a1
rooms = poverty$rooms
v2a1 = poverty$v2a1
rooms = poverty$rooms
v18q1 = poverty$v18q1
r4h1 = poverty$r4h1
r4h2 = poverty$r4h2
r4h3 = poverty$r4h3
r4m1 = poverty$r4m1
r4m2 = poverty$r4m2
r4m3 = poverty$r4m3
r4t1 = poverty$r4t1
r4t2 = poverty$r4t2
r4t3 = poverty$r4t3
tamhog = poverty$tamhog
tamviv = poverty$tamviv
escolari = poverty$escolari
rez_esc = poverty$rez_esc
hhsize = poverty$hhsize
hogar_nin = poverty$hogar_nin
hogar_adul = poverty$hogar_adul
hogar_mayor = poverty$hogar_mayor
hogar_total = poverty$hogar_total
dependency = poverty$dependency
edjefe = poverty$edjefe
edjefa = poverty$edjefa
meaneduc = poverty$meaneduc
bedrooms = poverty$bedrooms
overcrowding = poverty$overcrowding
qmobilephone = poverty$qmobilephone
age = poverty$age
SQBescolari = poverty$SQBescolari
SQBage = poverty$SQBage
SQBhogar_total = poverty$SQBhogar_total
SQBedjefe = poverty$SQBedjefe
SQBhogar_nin = poverty$SQBhogar_nin
SQBovercrowding = poverty$SQBovercrowding
SQBdependency = poverty$SQBdependency
SQBmeaned = poverty$SQBmeaned
agesq = poverty$agesq
```

## Household vs. Individual-Level Variables

The data includes variables at two levels:

-   Household-level: Variables like rooms, electricity type, and toilet type describe the collective living conditions of the household.

-   Individual-level: Variables like age, gender, and years of education provide details about each household member.\
    Since the focus is on heads of household, individual-level data for non-heads was aggregated to derive household-level insights.

    -   For example: The number of children, adults, and elderly members in a household was calculated.

-   Average years of schooling for adults was used as a measure of household educational attainment.

### Household-Level

```{r echo=FALSE, fig.align='center'}
ggplot(poverty, aes(x = factor(target), y = rooms)) +
  geom_boxplot(fill = "lightblue", color = "black") +
  labs(title = "Distribution of Number of Rooms by Poverty Level",
       x = "Poverty Level",
       y = "Number of Rooms") +
  theme_minimal()
```

Poverty levels 3 and 4 had a higher average number of rooms being in being closer to 5 and levels 1 and 2 being 4.

We created a new variable electricity_type for the following variables: public, noelec, planpri, and coopele. Now we can see the distribution of for each electricity over the different poverty levels.

```{r echo=FALSE, fig.align='center'}
#creates new column with electricity type 
poverty$electricity_type[poverty$public == 1] <- "public"
poverty$electricity_type[poverty$planpri == 1] <- "planpri"
poverty$electricity_type[poverty$noelec == 1] <- "noelec"
poverty$electricity_type[poverty$coopele == 1] <- "coopele"
electricity_type = factor(poverty$electricity_type)


ggplot(poverty, aes(x = electricity_type, fill = target)) +
  geom_bar(position = "dodge") +
  labs(title = "Electricity Type vs Poverty Level",
       x = "Electricity Type",
       y = "Count",
       fill = "Poverty Level") +
  theme_minimal()

```

| Cooperative | No Electricity | Private Plant |
|-------------|----------------|---------------|
| 991         | 20             | 3             |

The most common type of electricity is public and based off the graph, it is more likely to be classified as a non-vulnerable household if you have public electricity and electricity from cooperative. There is not enough data for no electricity or private plant electricity to make an assumption.

```{r echo=FALSE, warning=FALSE, fig.align='center'}
poverty$toilet_type[poverty$sanitario1 == 1] <- "no toilet"
poverty$toilet_type[poverty$sanitario2 == 1] <- "sewer/cesspool"
poverty$toilet_type[poverty$sanitario3 == 1] <- "septic tank"
poverty$toilet_type[poverty$sanitario5 == 1] <- "black hole/letrine"
poverty$toilet_type[poverty$sanitario6 == 1] <- "other system"

toilet_type = factor(poverty$toilet_type)


ggplot(poverty, aes(x = toilet_type, fill = target)) +
  geom_bar(position = "dodge") +
  labs(title = "Toilet Type vs Poverty Level",
       x = "Toilet Type",
       y = "Count",
       fill = "Poverty Level") +
  theme_minimal()
```

The most common type of toilet is septic tank and sewer. Based off the graph, it is more likely to be classified as a non-vulnerable household if you have those two types of toilets. There is not enough data for other types of toilet.

### Individual Level

```{r echo=FALSE, warning=FALSE, fig.align='center'}
boxplot(edjefe, edjefa, 
        names = c("Male", "Female"),
        main = "Years of Schooling by Heads of Households",
        ylab = "Years of Schooling",
        col = c("blue", "red"),
        border = "black")
```

| Statistic    | Female | Male  |
|--------------|--------|-------|
| Minimum      | 25     | 40    |
| 1st Quartile | 30     | 30    |
| Median       | 50     | 10    |
| Mean         | 8.412  | 8.505 |
| 3rd Quartile | 11     | 11    |
| Maximum      | 21     | 21    |
| NA's         | 5957   | 3626  |

This shows that the distribution of years of schooling is relatively the same for both male and female head of households.

```{r echo=FALSE, warning=FALSE, fig.align='center'}
ggplot(poverty, aes(x = escolari, y = target)) +
  geom_point(color = "darkred") +
  labs(x = "Years of Schooling", y = "Poverty Level") +
  theme_minimal()
```

It does not appear that years of schooling has a major impact on the classification of one's poverty level.

## Correlated Variables

Exploration revealed correlations among some variables. For instance:

-   Rooms and bedrooms are highly correlated, as both describe the household's living space.

-   tamviv (household size) and hogar_total (total individuals in the household) are similar and provide redundant information.\
    To handle these correlations, we selected one representative variable.

## Variable Importance

Key variables likely to influence poverty classification include:

-   Living conditions: Number of rooms, overcrowding rate, and toilet type.

-   Assets: Presence of a refrigerator, computer, or mobile phone.

-   Education: Average years of schooling for adults and the education level of the head of household.

-   Location: Urban/rural classification and region of residence.

```{r, include=FALSE}
#filtering poverty test data
poverty_test$v18q1[is.na(poverty_test$v18q1)] = 0

#this checks that condition
all(poverty_test$tipovivi1 != 1 | is.na(poverty_test$v2a1))

#replaces NA values with 0 because there is no monthly rent payment since the house is owned and fully paid
poverty_test$v2a1[is.na(poverty_test$v2a1)] = 0

# Find cases where edjefe is "yes", but either male is not 1 or parentesco1 is not 1
incorrect_condition2 <- poverty_test$edjefe == "yes" & (poverty_test$male != 1 | poverty_test$parentesco1 != 1)

#TRUE means the condition doesn't hold, FALSE means it's satisfied.
table(incorrect_condition2)

#same thing but for edjefa
incorrect_condition12 <- poverty_test$edjefa == "yes" & (poverty_test$female != 1 | poverty_test$parentesco1 != 1)
table(incorrect_condition12)

#correcting the data by changing "yes" to "no" in edjefe where it's inconsistent
poverty_test$edjefe <- ifelse(poverty_test$edjefe == "yes" & !(poverty_test$male == 1 & poverty_test$parentesco1== 1), "no", poverty_test$edjefe)

#correcting the data by changing "yes" to "no" in edjefa where it's inconsistent
poverty_test$edjefa <- ifelse(poverty_test$edjefa == "yes" & !(poverty_test$female == 1 & poverty_test$parentesco1 == 1), "no", poverty_test$edjefa)

poverty_test$edjefe <- ifelse(poverty_test$edjefe == "yes" & poverty_test$parentesco1 == 1 & poverty_test$male == 1, poverty_test$escolari, as.numeric(poverty_test$edjefe))

poverty_test$edjefa <- ifelse(poverty_test$edjefa == "yes" & poverty_test$parentesco1 == 1 & poverty_test$female == 1, poverty_test$escolari, as.numeric(poverty_test$edjefa))

poverty_test$gender = ifelse(poverty_test$male == 1, 1, 0)

##variables
poverty_test$target = factor(poverty_test$Target, ordered = TRUE)
poverty_test$target = factor(poverty_test$Target, levels = c(1, 2, 3, 4))
#factoring variables 
poverty_test$hacdor = factor(poverty_test$hacdor)
poverty_test$hacapo = factor(poverty_test$hacapo)
poverty_test$v14a = factor(poverty_test$v14a)
poverty_test$refrig = factor(poverty_test$refrig)
poverty_test$v18q = factor(poverty_test$v18q)
poverty_test$paredblolad = factor(poverty_test$paredblolad)
poverty_test$paredzocalo = factor(poverty_test$paredzocalo)
poverty_test$paredpreb = factor(poverty_test$paredpreb)
poverty_test$pareddes = factor(poverty_test$pareddes)
poverty_test$paredmad = factor(poverty_test$paredmad)
poverty_test$paredzinc = factor(poverty_test$paredzinc)
poverty_test$paredfibras = factor(poverty_test$paredfibras)
poverty_test$paredother = factor(poverty_test$paredother)
poverty_test$pisomoscer = factor(poverty_test$pisomoscer)
poverty_test$pisocemento = factor(poverty_test$pisocemento)
poverty_test$pisoother = factor(poverty_test$pisoother)
poverty_test$pisonatur = factor(poverty_test$pisonatur)
poverty_test$pisonotiene = factor(poverty_test$pisonotiene)
poverty_test$pisomadera = factor(poverty_test$pisomadera)
poverty_test$techozinc = factor(poverty_test$techozinc)
poverty_test$techoentrepiso = factor(poverty_test$techoentrepiso)
poverty_test$techocane = factor(poverty_test$techocane)
poverty_test$techootro = factor(poverty_test$techootro)
poverty_test$cielorazo = factor(poverty_test$cielorazo)
poverty_test$abastaguadentro = factor(poverty_test$abastaguadentro)
poverty_test$abastaguafuera = factor(poverty_test$abastaguafuera)
poverty_test$abastaguano = factor(poverty_test$abastaguano)
poverty_test$public = factor(poverty_test$public)
poverty_test$planpri = factor(poverty_test$planpri)
poverty_test$noelec = factor(poverty_test$noelec)
poverty_test$coopele = factor(poverty_test$coopele)
poverty_test$sanitario1 = factor(poverty_test$sanitario1)
poverty_test$sanitario2 = factor(poverty_test$sanitario2)
poverty_test$sanitario3 = factor(poverty_test$sanitario3)
poverty_test$sanitario5 = factor(poverty_test$sanitario5)
poverty_test$sanitario6 = factor(poverty_test$sanitario6)
poverty_test$energcocinar1 = factor(poverty_test$energcocinar1)
poverty_test$energcocinar2 = factor(poverty_test$energcocinar2)
poverty_test$energcocinar3 = factor(poverty_test$energcocinar3)
poverty_test$energcocinar4 = factor(poverty_test$energcocinar4)
poverty_test$elimbasu1 = factor(poverty_test$elimbasu1)
poverty_test$elimbasu2 = factor(poverty_test$elimbasu2)
poverty_test$elimbasu3 = factor(poverty_test$elimbasu3)
poverty_test$elimbasu4 = factor(poverty_test$elimbasu4)
poverty_test$elimbasu5 = factor(poverty_test$elimbasu5)
poverty_test$elimbasu6 = factor(poverty_test$elimbasu6)
poverty_test$epared1 = factor(poverty_test$epared1)
poverty_test$epared2 = factor(poverty_test$epared2)
poverty_test$epared3 = factor(poverty_test$epared3)
poverty_test$etecho1 = factor(poverty_test$etecho1)
poverty_test$etecho2 = factor(poverty_test$etecho2)
poverty_test$etecho3 = factor(poverty_test$etecho3)
poverty_test$eviv1 = factor(poverty_test$eviv1)
poverty_test$eviv2 = factor(poverty_test$eviv2)
poverty_test$eviv3 = factor(poverty_test$eviv3)
poverty_test$dis = factor(poverty_test$dis)
poverty_test$male = factor(poverty_test$male)
poverty_test$female = factor(poverty_test$female)
poverty_test$estadocivil1 = factor(poverty_test$estadocivil1)
poverty_test$estadocivil2 = factor(poverty_test$estadocivil2)
poverty_test$estadocivil3 = factor(poverty_test$estadocivil3)
poverty_test$estadocivil4 = factor(poverty_test$estadocivil4)
poverty_test$estadocivil5 = factor(poverty_test$estadocivil5)
poverty_test$estadocivil6 = factor(poverty_test$estadocivil6)
poverty_test$estadocivil7 = factor(poverty_test$estadocivil7)
poverty_test$parentesco1 = factor(poverty_test$parentesco1)
poverty_test$parentesco2 = factor(poverty_test$parentesco2)
poverty_test$parentesco3 = factor(poverty_test$parentesco3)
poverty_test$parentesco4 = factor(poverty_test$parentesco4)
poverty_test$parentesco5 = factor(poverty_test$parentesco5)
poverty_test$parentesco6 = factor(poverty_test$parentesco6)
poverty_test$parentesco7 = factor(poverty_test$parentesco7)
poverty_test$parentesco8 = factor(poverty_test$parentesco8)
poverty_test$parentesco9 = factor(poverty_test$parentesco9)
poverty_test$parentesco10 = factor(poverty_test$parentesco10)
poverty_test$parentesco11 = factor(poverty_test$parentesco11)
poverty_test$parentesco12 = factor(poverty_test$parentesco12)
poverty_test$idhogar = factor(poverty_test$idhogar)
poverty_test$lugar1 = factor(poverty_test$lugar1)
poverty_test$lugar2 = factor(poverty_test$lugar2)
poverty_test$lugar3 = factor(poverty_test$lugar3)
poverty_test$lugar4 = factor(poverty_test$lugar4)
poverty_test$lugar5 = factor(poverty_test$lugar5)

poverty_test$area1 = factor(poverty_test$area1)
poverty_test$area2 = factor(poverty_test$area2)

#other variables that don't need to be factor
poverty_test$gender = poverty_test$gender
poverty_test$v2a1 = poverty_test$v2a1
poverty_test$rooms = poverty_test$rooms
poverty_test$v18q1 = poverty_test$v18q1
poverty_test$r4h1 = poverty_test$r4h1
poverty_test$r4h2 = poverty_test$r4h2
poverty_test$r4h3 = poverty_test$r4h3
poverty_test$r4m1 = poverty_test$r4m1
poverty_test$r4m2 = poverty_test$r4m2
poverty_test$r4m3 = poverty_test$r4m3
poverty_test$r4t1 = poverty_test$r4t1
poverty_test$r4t2 = poverty_test$r4t2
poverty_test$r4t3 = poverty_test$r4t3
poverty_test$tamhog = poverty_test$tamhog
poverty_test$tamviv = poverty_test$tamviv
poverty_test$escolari = poverty_test$escolari
poverty_test$rez_esc = poverty_test$rez_esc
poverty_test$hhsize = poverty_test$hhsize
poverty_test$hogar_nin = poverty_test$hogar_nin
poverty_test$hogar_adul = poverty_test$hogar_adul
poverty_test$hogar_mayor = poverty_test$hogar_mayor
poverty_test$hogar_total = poverty_test$hogar_total
poverty_test$dependency = poverty_test$dependency
poverty_test$edjefe = poverty_test$edjefe
poverty_test$edjefa = poverty_test$edjefa
poverty_test$meaneduc = poverty_test$meaneduc
poverty_test$bedrooms = poverty_test$bedrooms
poverty_test$overcrowding = poverty_test$overcrowding
poverty_test$qmobilephone = poverty_test$qmobilephone
poverty_test$age = poverty_test$age
poverty_test$SQBescolari = poverty_test$SQBescolari
poverty_test$SQBage = poverty_test$SQBage
poverty_test$SQBhogar_total = poverty_test$SQBhogar_total
poverty_test$SQBedjefe = poverty_test$SQBedjefe
poverty_test$SQBhogar_nin = poverty_test$SQBhogar_nin
poverty_test$SQBovercrowding = poverty_test$SQBovercrowding
poverty_test$SQBdependency = poverty_test$SQBdependency
poverty_test$SQBmeaned = poverty_test$SQBmeaned
poverty_test$agesq = poverty_test$agesq
```

```{r, include=FALSE, warning=FALSE}
poverty_test$electricity_type[poverty_test$public == 1] <- "public"
poverty_test$electricity_type[poverty_test$planpri == 1] <- "planpri"
poverty_test$electricity_type[poverty_test$noelec == 1] <- "noelec"
poverty_test$electricity_type[poverty_test$coopele == 1] <- "coopele"
electricity_type_t = factor(poverty_test$electricity_type)

poverty_test$toilet_type[poverty_test$sanitario1 == 1] <- "no toilet"
poverty_test$toilet_type[poverty_test$sanitario2 == 1] <- "sewer/cesspool"
poverty_test$toilet_type[poverty_test$sanitario3 == 1] <- "septic tank"
poverty_test$toilet_type[poverty_test$sanitario5 == 1] <- "black hole/letrine"
poverty_test$toilet_type[poverty_test$sanitario6 == 1] <- "other system"

poverty_test$toilet_type = factor(poverty_test$toilet_type)

```

```{r, include=FALSE, warning=FALSE}
#splitting data into training and testing datasets and setting seed
set.seed(234)
train.p = sample(1:nrow(poverty), floor(.75 * nrow(poverty)), replace = FALSE)
p.tr <- poverty[train.p, ]
p.te <- poverty[-train.p, ]
head(p.tr)

p.tr$target = factor(p.tr$Target, ordered = TRUE)
p.tr$target <- factor(p.tr$Target, levels = c(1, 2, 3, 4))

#factoring variables 
p.tr$hacdor = factor(p.tr$hacdor)
p.tr$hacapo = factor(p.tr$hacapo)
p.tr$v14a = factor(p.tr$v14a)
p.tr$refrig = factor(p.tr$refrig)
p.tr$v18q = factor(p.tr$v18q)
p.tr$paredblolad = factor(p.tr$paredblolad)
p.tr$paredzocalo <- factor(p.tr$paredzocalo)
p.tr$paredpreb <- factor(p.tr$paredpreb)
p.tr$pareddes <- factor(p.tr$pareddes)
p.tr$paredmad <- factor(p.tr$paredmad)
p.tr$paredzinc <- factor(p.tr$paredzinc)
p.tr$paredfibras <- factor(p.tr$paredfibras)
p.tr$paredother <- factor(p.tr$paredother)
p.tr$pisomoscer = factor(p.tr$pisomoscer)
p.tr$pisocemento = factor(p.tr$pisocemento)
p.tr$pisoother = factor(p.tr$pisoother)
p.tr$pisonatur = factor(p.tr$pisonatur)
p.tr$pisonotiene = factor(p.tr$pisonotiene)
p.tr$pisomadera = factor(p.tr$pisomadera)
p.tr$techozinc = factor(p.tr$techozinc)
p.tr$techoentrepiso = factor(p.tr$techoentrepiso)
p.tr$techocane = factor(p.tr$techocane)
p.tr$techootro = factor(p.tr$techootro)
p.tr$cielorazo = factor(p.tr$cielorazo)
p.tr$abastaguadentro = factor(p.tr$abastaguadentro)
p.tr$abastaguafuera = factor(p.tr$abastaguafuera)
p.tr$abastaguano = factor(p.tr$abastaguano)
p.tr$public = factor(p.tr$public)
p.tr$planpri = factor(p.tr$planpri)
p.tr$noelec = factor(p.tr$noelec)
p.tr$coopele = factor(p.tr$coopele)
p.tr$sanitario1 = factor(p.tr$sanitario1)
p.tr$sanitario2 = factor(p.tr$sanitario2)
p.tr$sanitario3 = factor(p.tr$sanitario3)
p.tr$sanitario5 = factor(p.tr$sanitario5)
p.tr$sanitario6 = factor(p.tr$sanitario6)
p.tr$energcocinar1 = factor(p.tr$energcocinar1)
p.tr$energcocinar2 = factor(p.tr$energcocinar2)
p.tr$energcocinar3 = factor(p.tr$energcocinar3)
p.tr$energcocinar4 = factor(p.tr$energcocinar4)
p.tr$elimbasu1 = factor(p.tr$elimbasu1)
p.tr$elimbasu2 = factor(p.tr$elimbasu2)
p.tr$elimbasu3 = factor(p.tr$elimbasu3)
p.tr$elimbasu4 = factor(p.tr$elimbasu4)
p.tr$elimbasu5 = factor(p.tr$elimbasu5)
p.tr$elimbasu6 = factor(p.tr$elimbasu6)
p.tr$epared1 = factor(p.tr$epared1)
p.tr$epared2 = factor(p.tr$epared2)
p.tr$epared3 = factor(p.tr$epared3)
p.tr$etecho1 = factor(p.tr$etecho1)
p.tr$etecho2 = factor(p.tr$etecho2)
p.tr$etecho3 = factor(p.tr$etecho3)
p.tr$eviv1 = factor(p.tr$eviv1)
p.tr$eviv2 = factor(p.tr$eviv2)
p.tr$eviv3 = factor(p.tr$eviv3)
p.tr$dis = factor(p.tr$dis)
p.tr$male = factor(p.tr$male)
p.tr$female = factor(p.tr$female)
p.tr$estadocivil1 = factor(p.tr$estadocivil1)
p.tr$estadocivil2 = factor(p.tr$estadocivil2)
p.tr$estadocivil3 = factor(p.tr$estadocivil3)
p.tr$estadocivil4 = factor(p.tr$estadocivil4)
p.tr$estadocivil5 = factor(p.tr$estadocivil5)
p.tr$estadocivil6 = factor(p.tr$estadocivil6)
p.tr$estadocivil7 = factor(p.tr$estadocivil7)
p.tr$parentesco1 = factor(p.tr$parentesco1)
p.tr$parentesco2 = factor(p.tr$parentesco2)
p.tr$parentesco3 = factor(p.tr$parentesco3)
p.tr$parentesco4 = factor(p.tr$parentesco4)
p.tr$parentesco5 = factor(p.tr$parentesco5)
p.tr$parentesco6 = factor(p.tr$parentesco6)
p.tr$parentesco7 = factor(p.tr$parentesco7)
p.tr$parentesco8 = factor(p.tr$parentesco8)
p.tr$parentesco9 = factor(p.tr$parentesco9)
p.tr$parentesco10 = factor(p.tr$parentesco10)
p.tr$parentesco11 = factor(p.tr$parentesco11)
p.tr$parentesco12 = factor(p.tr$parentesco12)
p.tr$idhogar = factor(p.tr$idhogar)
p.tr$lugar1 = factor(p.tr$lugar1)
p.tr$lugar2 = factor(p.tr$lugar2)
p.tr$lugar3 = factor(p.tr$lugar3)
p.tr$lugar4 = factor(p.tr$lugar4)
p.tr$lugar5 = factor(p.tr$lugar5)

p.tr$area1 = factor(p.tr$area1)
p.tr$area2 = factor(p.tr$area2)

#other variables that don't need to be factor
p.tr$gender = p.tr$gender
p.tr$v2a1 = p.tr$v2a1
p.tr$rooms = p.tr$rooms
p.tr$v18q1 = p.tr$v18q1
p.tr$r4h1 = p.tr$r4h1
p.tr$r4h2 = p.tr$r4h2
p.tr$r4h3 = p.tr$r4h3
p.tr$r4m1 = p.tr$r4m1
p.tr$r4m2 = p.tr$r4m2
p.tr$r4m3 = p.tr$r4m3
p.tr$r4t1 = p.tr$r4t1
p.tr$r4t2 = p.tr$r4t2
p.tr$r4t3 = p.tr$r4t3
p.tr$tamhog = p.tr$tamhog
p.tr$tamviv = p.tr$tamviv
p.tr$escolari = p.tr$escolari
p.tr$rez_esc = p.tr$rez_esc
p.tr$hhsize = p.tr$hhsize
p.tr$hogar_nin = p.tr$hogar_nin
p.tr$hogar_adul = p.tr$hogar_adul
p.tr$hogar_mayor = p.tr$hogar_mayor
p.tr$hogar_total = p.tr$hogar_total
p.tr$dependency = p.tr$dependency
p.tr$edjefe = p.tr$edjefe
p.tr$edjefa = p.tr$edjefa
p.tr$meaneduc = p.tr$meaneduc
p.tr$bedrooms = p.tr$bedrooms
p.tr$overcrowding = p.tr$overcrowding
p.tr$qmobilephone = p.tr$qmobilephone
p.tr$age = p.tr$age
p.tr$SQBescolari = p.tr$SQBescolari
p.tr$SQBage = p.tr$SQBage
p.tr$SQBhogar_total = p.tr$SQBhogar_total
p.tr$SQBedjefe = p.tr$SQBedjefe
p.tr$SQBhogar_nin = p.tr$SQBhogar_nin
p.tr$SQBovercrowding = p.tr$SQBovercrowding
p.tr$SQBdependency = p.tr$SQBdependency
p.tr$SQBmeaned = p.tr$SQBmeaned
p.tr$agesq = p.tr$agesq

p.tr$electricity_type[p.tr$public == 1] <- "public"
p.tr$electricity_type[p.tr$planpri == 1] <- "planpri"
p.tr$electricity_type[p.tr$noelec == 1] <- "noelec"
p.tr$electricity_type[p.tr$coopele == 1] <- "coopele"
electricity_type_tr = factor(p.tr$electricity_type)

p.tr$toilet_type[p.tr$sanitario1 == 1] <- "no toilet"
p.tr$toilet_type[p.tr$sanitario2 == 1] <- "sewer/cesspool"
p.tr$toilet_type[p.tr$sanitario3 == 1] <- "septic tank"
p.tr$toilet_type[p.tr$sanitario5 == 1] <- "black hole/letrine"
p.tr$toilet_type[p.tr$sanitario6 == 1] <- "other system"

p.tr$toilet_type = factor(p.tr$toilet_type)
  
###################################

p.te$target = factor(p.te$Target, ordered = TRUE)
p.te$target <- factor(p.te$Target, levels = c(1, 2, 3, 4))

#factoring variables 
p.te$hacdor = factor(p.te$hacdor)
p.te$hacapo = factor(p.te$hacapo)
p.te$v14a = factor(p.te$v14a)
p.te$refrig = factor(p.te$refrig)
p.te$v18q = factor(p.te$v18q)
p.te$paredblolad = factor(p.te$paredblolad)
p.te$paredzocalo <- factor(p.te$paredzocalo)
p.te$paredpreb <- factor(p.te$paredpreb)
p.te$pareddes <- factor(p.te$pareddes)
p.te$paredmad <- factor(p.te$paredmad)
p.te$paredzinc = factor(p.te$paredzinc)
p.te$paredfibras = factor(p.te$paredfibras)
p.te$paredother = factor(p.te$paredother)
p.te$pisomoscer = factor(p.te$pisomoscer)
p.te$pisocemento = factor(p.te$pisocemento)
p.te$pisoother = factor(p.te$pisoother)
p.te$pisonatur = factor(p.te$pisonatur)
p.te$pisonotiene = factor(p.te$pisonotiene)
p.te$pisomadera = factor(p.te$pisomadera)
p.te$techozinc = factor(p.te$techozinc)
p.te$techoentrepiso = factor(p.te$techoentrepiso)
p.te$techocane = factor(p.te$techocane)
p.te$techootro = factor(p.te$techootro)
p.te$cielorazo = factor(p.te$cielorazo)
p.te$abastaguadentro = factor(p.te$abastaguadentro)
p.te$abastaguafuera = factor(p.te$abastaguafuera)
p.te$abastaguano = factor(p.te$abastaguano)
p.te$public = factor(p.te$public)
p.te$planpri = factor(p.te$planpri)
p.te$noelec = factor(p.te$noelec)
p.te$coopele = factor(p.te$coopele)
p.te$sanitario1 = factor(p.te$sanitario1)
p.te$sanitario2 = factor(p.te$sanitario2)
p.te$sanitario3 = factor(p.te$sanitario3)
p.te$sanitario5 = factor(p.te$sanitario5)
p.te$sanitario6 = factor(p.te$sanitario6)
p.te$energcocinar1 = factor(p.te$energcocinar1)
p.te$energcocinar2 = factor(p.te$energcocinar2)
p.te$energcocinar3 = factor(p.te$energcocinar3)
p.te$energcocinar4 = factor(p.te$energcocinar4)
p.te$elimbasu1 = factor(p.te$elimbasu1)
p.te$elimbasu2 = factor(p.te$elimbasu2)
p.te$elimbasu3 = factor(p.te$elimbasu3)
p.te$elimbasu4 = factor(p.te$elimbasu4)
p.te$elimbasu5 = factor(p.te$elimbasu5)
p.te$elimbasu6 = factor(p.te$elimbasu6)
p.te$epared1 = factor(p.te$epared1)
p.te$epared2 = factor(p.te$epared2)
p.te$epared3 = factor(p.te$epared3)
p.te$etecho1 = factor(p.te$etecho1)
p.te$etecho2 = factor(p.te$etecho2)
p.te$etecho3 = factor(p.te$etecho3)
p.te$eviv1 = factor(p.te$eviv1)
p.te$eviv2 = factor(p.te$eviv2)
p.te$eviv3 = factor(p.te$eviv3)
p.te$dis = factor(p.te$dis)
p.te$male = factor(p.te$male)
p.te$female = factor(p.te$female)
p.te$estadocivil1 = factor(p.te$estadocivil1)
p.te$estadocivil2 = factor(p.te$estadocivil2)
p.te$estadocivil3 = factor(p.te$estadocivil3)
p.te$estadocivil4 = factor(p.te$estadocivil4)
p.te$estadocivil5 = factor(p.te$estadocivil5)
p.te$estadocivil6 = factor(p.te$estadocivil6)
p.te$estadocivil7 = factor(p.te$estadocivil7)
p.te$parentesco1 = factor(p.te$parentesco1)
p.te$parentesco2 = factor(p.te$parentesco2)
p.te$parentesco3 = factor(p.te$parentesco3)
p.te$parentesco4 = factor(p.te$parentesco4)
p.te$parentesco5 = factor(p.te$parentesco5)
p.te$parentesco6 = factor(p.te$parentesco6)
p.te$parentesco7 = factor(p.te$parentesco7)
p.te$parentesco8 = factor(p.te$parentesco8)
p.te$parentesco9 = factor(p.te$parentesco9)
p.te$parentesco10 = factor(p.te$parentesco10)
p.te$parentesco11 = factor(p.te$parentesco11)
p.te$parentesco12 = factor(p.te$parentesco12)
p.te$idhogar = factor(p.te$idhogar)
p.te$lugar1 = factor(p.te$lugar1)
p.te$lugar2 = factor(p.te$lugar2)
p.te$lugar3 = factor(p.te$lugar3)
p.te$lugar4 = factor(p.te$lugar4)
p.te$lugar5 = factor(p.te$lugar5)

p.te$area1 = factor(p.te$area1)
p.te$area2 = factor(p.te$area2)

#other variables that don't need to be factor
p.te$gender = p.te$gender
p.te$v2a1 = p.te$v2a1
p.te$rooms = p.te$rooms
p.te$v18q1 = p.te$v18q1
p.te$r4h1 = p.te$r4h1
p.te$r4h2 = p.te$r4h2
p.te$r4h3 = p.te$r4h3
p.te$r4m1 = p.te$r4m1
p.te$r4m2 = p.te$r4m2
p.te$r4m3 = p.te$r4m3
p.te$r4t1 = p.te$r4t1
p.te$r4t2 = p.te$r4t2
p.te$r4t3 = p.te$r4t3
p.te$tamhog = p.te$tamhog
p.te$tamviv = p.te$tamviv
p.te$escolari = p.te$escolari
p.te$rez_esc = p.te$rez_esc
p.te$hhsize = p.te$hhsize
p.te$hogar_nin = p.te$hogar_nin
p.te$hogar_adul = p.te$hogar_adul
p.te$hogar_mayor = p.te$hogar_mayor
p.te$hogar_total = p.te$hogar_total
p.te$dependency = p.te$dependency
p.te$edjefe = p.te$edjefe
p.te$edjefa = p.te$edjefa
p.te$meaneduc = p.te$meaneduc
p.te$bedrooms = p.te$bedrooms
p.te$overcrowding = p.te$overcrowding
p.te$qmobilephone = p.te$qmobilephone
p.te$age = p.te$age
p.te$SQBescolari = p.te$SQBescolari
p.te$SQBage = p.te$SQBage
p.te$SQBhogar_total = p.te$SQBhogar_total
p.te$SQBedjefe = p.te$SQBedjefe
p.te$SQBhogar_nin = p.te$SQBhogar_nin
p.te$SQBovercrowding = p.te$SQBovercrowding
p.te$SQBdependency = p.te$SQBdependency
p.te$SQBmeaned = p.te$SQBmeaned
p.te$agesq = p.te$agesq



p.te$electricity_type[p.te$public == 1] <- "public"
p.te$electricity_type[p.te$planpri == 1] <- "planpri"
p.te$electricity_type[p.te$noelec == 1] <- "noelec"
p.te$electricity_type[p.te$coopele == 1] <- "coopele"
electricity_type_te = factor(p.te$electricity_type)

p.te$toilet_type[p.te$sanitario1 == 1] <- "no toilet"
p.te$toilet_type[p.te$sanitario2 == 1] <- "sewer/cesspool"
p.te$toilet_type[p.te$sanitario3 == 1] <- "septic tank"
p.te$toilet_type[p.te$sanitario5 == 1] <- "black hole/letrine"
p.te$toilet_type[p.te$sanitario6 == 1] <- "other system"

p.te$toilet_type = factor(p.te$toilet_type)

```

```{r, warning=FALSE, message=FALSE}
#model using the key variables found during data exploration

model = glm(target ~ toilet_type + rooms + computer + overcrowding+ refrig + mobilephone + meaneduc + escolari + lugar1 + lugar2 + lugar3 + lugar4 + lugar5 + area1 + area2, family = binomial,data=p.tr)

```

## Practical Insights

Understanding the socioeconomic conditions of non-head household members was valuable in summarizing household dynamics. For example, the number of dependents (children and elderly) relative to working-age adults provides a clearer picture of household dependency, which is a critical factor in poverty classification.\
This data exploration phase lays the groundwork for creating a predictive model by addressing missing data, selecting relevant features, and ensuring the dataset is well-prepared for training and testing.

# Model Selection

The model selection process considered the nature of the data, the ordinal structure of the target variable, and the project's goals of interpretability and accuracy.

## Models Considered

The primary considerations for selecting the best model included:

-   **Predictive Performance:** Measured using accuracy, F1 score, and metrics that account for the ordinal nature of the target variable.

-   **Interpretability:** Priority was given to models that provide insight into the relationships between features and poverty levels, aiding practical decision-making.

-   **Handling of Missing Data and Multicollinearity:** Models were assessed based on their ability to handle missing values and highly correlated features.

We first used multinomial logistic regression for the multi-class classification task. Our accuracy was 0.679 and a low F1 score of 0.178 revealed that it would be useful to look at the class imbalance. Class counts revealed there are significantly more people in non-vulnerable households than in vulnerable households or poverty. We also noticed that our model predicted a 4 for an outcome when it was really 1,2, or 3. It was predicting a non-vulnerable household when in reality it was a vulnerable or poverty household. Our model also often predicted a 2 when it was really a 1,3, or 4.

```{r, results='hide', warning=FALSE, message=FALSE}
set.seed(234)
#multinom model for training dataset
model1 <- multinom(target ~ toilet_type + rooms + computer+ hogar_total + overcrowding + refrig  + mobilephone + escolari + lugar1 + lugar2 + lugar3 + lugar4 + lugar5+area1+area2+v2a1+r4h3+r4m3+r4t3+paredblolad+paredzocalo+paredpreb+paredmad+pisomoscer+pisocemento+techocane+cielorazo+etecho1+eviv1+dependency , data=p.tr)


#testing data
probabilities1 <- predict(model1,  newdata = p.te, type = "probs")
predictions1 <- predict(model1,newdata=p.te)
head(predictions1)
accuracy1 <- mean(predictions1 == p.te$target)
accuracy1

f1_1=F1_Score(predictions1,p.te$target)
f1_1

#class counts
length(which(p.tr$target==4))
length(which(p.tr$target==3))
length(which(p.tr$target==2))
length(which(p.tr$target==1))

```

```{r, warning=FALSE}
conf_matrix1 <- table(predictions1, p.te$target)
print(conf_matrix1)

```

Once the multinomial model revealed for us that we should take class imbalance into account, we moved on to explore other models:

-   Logistic Regression: A baseline model with high interpretability.

-   Random Forests: An ensemble method that reduces overfitting and captures complex interactions between variables while providing feature importance metrics.

```{r, warning=FALSE, message=FALSE}
set.seed(234)

model2 <- randomForest(target ~ toilet_type + rooms + computer+ hogar_total + overcrowding + refrig  + mobilephone + escolari + lugar1 + lugar2 + lugar3 + lugar4 + lugar5+area1+area2+v2a1+r4h3+r4m3+r4t3+paredblolad+paredzocalo+paredpreb+paredmad+pisomoscer+pisocemento+techocane+cielorazo+etecho1+eviv1+dependency, data = p.tr, ntree=50)

#Predictions on the test dataset 
predictions2 <- predict(model2, newdata = p.te, type = "class")

#confusion matrix
conf_matrix2 <- confusionMatrix(predictions2, p.te$target)
as.matrix(conf_matrix2,what="classes") 

accuracy2 <- mean(predictions2 == p.te$target)
accuracy2

#our F1 score with random forest increases from 0.1782178 on our multinomial model to 0.7959184 for random forest
f1_2=F1_Score(predictions2,p.te$target)
f1_2

```

## Random Forest Model for Training Dataset

We found that adding the total number of individuals in the household and monthly rent payment improved our accuracy of our model. Adding total males in household, total females in household, and total people in the household also raised our accuracy. The material of wall, floor, and roof helped increase our model's accuracy. Our F1 score with random forest increases from our multinomial model to 0.796 for Random Forest.

```{r, warning=FALSE, message=FALSE}
set.seed(234)
#Handling class weights
#https://medium.com/@ravi.abhinav4/improving-class-imbalance-with-class-weights-in-machine-learning-af072fdd4aa4 
class_weights= c(6792/(4*4254), 6792/(4*879), 6792/(4*1109), 6792/(4*550))
model3 <- randomForest(target ~ toilet_type + rooms + computer+ hogar_total + overcrowding + refrig  + mobilephone + escolari + lugar1 + lugar2 + lugar3 + lugar4 + lugar5+area1+area2+v2a1+r4h3+r4m3+r4t3+paredblolad+paredzocalo+paredpreb+paredmad+pisomoscer+pisocemento+techocane+cielorazo+etecho1+eviv1+dependency, data = p.tr, classwt=class_weights)

#Predictions on the test dataset
predictions3 <- predict(model3, newdata = p.te, type = "class")

#confusion matrix
conf_matrix3 = confusionMatrix(predictions3, p.te$target)
conf_matrix3
#find the f1 score for each target value
as.matrix(conf_matrix3,what="classes")  

accuracy3 <- mean(predictions3 == p.te$target)
accuracy3

f1_3=F1_Score(predictions3,p.te$target)
f1_3

```

## Handling of Imbalanced Data

The dataset’s target variable exhibited imbalanced class distributions, with some poverty levels being underrepresented. To address this:

-   **Class Weights**: Class weights were calculated based on the inverse frequency of each class and applied during model training. We found that applying class weights only brought up the accuracy by about 1% where we took the inverse frequency of the counts to account for the class imbalance.

-   **Evaluation Metrics**: Metrics such as the weighted F1 score and Cohen’s kappa were prioritized to ensure fair assessment across all classes.

-   **Avoidance of Undersampling**: Undersampling techniques were avoided to prevent loss of valuable information from the majority class.

The Random Forest model provided interpretable insights into the underlying patterns of poverty through feature importance rankings. Key findings include:

-   **Education and Assets:** Households with fewer years of schooling and lower levels of asset ownership were more likely to be classified into higher poverty levels.

-   **Household Structure:** Larger households with higher dependency ratios and overcrowding were strongly associated with higher poverty risk.

-   **Geographical and Housing Conditions:** Features such as household location (urban vs. rural) and housing conditions (e.g., type of roof, floor materials) also contributed significantly to poverty classification.

```{r, warning=FALSE, message=FALSE}
#Predicting target values for the poverty test blinded dataset

predictions3_test <- predict(model3, newdata = poverty_test, type = "class")
poverty_test$target=predictions3_test
write.csv(poverty_test, "poverty-test-blinded2.csv", row.names = FALSE)

```

# Results Summary

The goal of this analysis was to classify households into one of four poverty levels based on a set of socioeconomic and demographic variables. After evaluating multiple models and selecting the best one based on predictive performance and interpretability, our results follow:

## Model Performance

The final model selected was Random Forest. We assessed its performance using multiple metrics, considering both accuracy and the ordinal nature of the target variable.

-   **Accuracy**: The model achieved an overall accuracy of 0.8949 on the test set, indicating a strong ability to correctly classify households into the appropriate poverty categories.

-   **Precision, Recall, and F1 Score:** These metrics were calculated for each of the four poverty levels to ensure the model performs well across all classes. The F1 score for the most underrepresented category (e.g., "extreme poverty") was 0.8043, suggesting the model handles imbalanced classes effectively.

-   **Confusion Matrix:** The confusion matrix revealed that the model was particularly effective at distinguishing between classes 2 and 4, which had high sensitivity (0.7735 and 0.9770, respectively) and balanced accuracy (0.8761 and 0.8898, respectively). However, class 1 had lower sensitivity (0.6848), indicating challenges in correctly identifying households in this category. Misclassifications in this class may be due to overlapping feature values with other categories.

## Model Interpretability

While the selected model provided strong predictive performance, it also offered insights into the underlying patterns of poverty through its feature importance rankings. For example, households with fewer years of schooling and lower levels of asset ownership were more likely to be classified into higher poverty levels. Similarly, larger households with higher dependency ratios and overcrowding were associated with higher poverty risk. These insights can help inform targeted social interventions aimed at improving education and access to resources.
